name: Triá»ƒn khai ReactJS lÃªn Server

on:
  push:
    branches: [ "main" ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Láº¥y mÃ£ nguá»“n
        uses: actions/checkout@v3

      - name: CÃ i Ä‘áº·t thÆ° viá»‡n
        run: npm install

      - name: Build dá»± Ã¡n
        run: npm run build

      - name: Triá»ƒn khai lÃªn Server qua SSH
        uses: easingthemes/ssh-deploy@v4
        env:
          SSH_PRIVATE_KEY: ${{ secrets.SSH_KEY }}
          SOURCE: "dist/"
          REMOTE_HOST: "YOUR_SERVER_IP"
          REMOTE_USER: "ubuntu"
          TARGET: "/var/www/my-react-app"

      # ğŸ‰ ThÃ´ng bÃ¡o khi triá»ƒn khai thÃ nh cÃ´ng
      - name: Gá»­i thÃ´ng bÃ¡o Discord (ThÃ nh cÃ´ng)
        if: success()
        run: |
          curl -H "Content-Type: application/json" \
          -d "{
            \"content\": \"âœ… **Triá»ƒn khai thÃ nh cÃ´ng!**\nğŸ“Œ Repository: $GITHUB_REPOSITORY\nğŸ”§ Commit: $GITHUB_SHA\nğŸ¯ Má»i thá»© Ä‘Ã£ cháº¡y á»•n Ä‘á»‹nh trÃªn server.\"
          }" \
          ${{ secrets.DISCORD_WEBHOOK }}

      # â— ThÃ´ng bÃ¡o khi lá»—i build hoáº·c deploy
      - name: Gá»­i thÃ´ng bÃ¡o Discord (Tháº¥t báº¡i)
        if: failure()
        run: |
          curl -H "Content-Type: application/json" \
          -d "{
            \"content\": \"âŒ **Triá»ƒn khai tháº¥t báº¡i!**\nâš  ÄÃ£ xáº£y ra lá»—i trong quÃ¡ trÃ¬nh Build hoáº·c Deploy.\nğŸ“Œ Repository: $GITHUB_REPOSITORY\nâ¡ Vui lÃ²ng kiá»ƒm tra láº¡i *GitHub Actions Logs* Ä‘á»ƒ biáº¿t chi tiáº¿t.\"
          }" \
          ${{ secrets.DISCORD_WEBHOOK }}
